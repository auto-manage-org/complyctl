.\" Automatically generated by Pandoc 3.1.11.1
.\"
.TH "COMPLYCTL_OPENSCAP\-PLUGIN" "7" "July 2025" "Complyctl OpenSCAP Plugin" ""
.SH NAME
complyctl\-openscap\-plugin \- a plugin which extends the complyctl
capabilities to use OpenSCAP.
.SH DESCRIPTION
The plugin is not meant to be executed directly, it communicates with
complyctl via gRPC.
It has configurable options that can be configured via a manifest file,
complyctl processes the manifest file and sends the configuration values
to the plugin.
Plugin execution occurs when running the complyctl \f[B]generate\f[R]
and \f[B]scan\f[R] commands.
.PP
When the plugin receives the \f[B]generate\f[R] command from complyctl,
it will generate a tailoring policy file and remediation files for Bash,
Ansible, and Image Builder.
The generated tailoring policy file extends the Datastream profile by
overriding rules and variables as defined in the assessment\-plan.json.
During this process, the plugin also performs a validation of rules and
parameters by comparing information between the Assessment Plan and the
Datastream to ensure the tailoring policy includes only valid content
for the scanner regardless of the content alignment between OSCAL and
SCAP.
The plugins does not execute remediation but make the generated
artifacts available to be used externally.
The generated files are placed in the \f[B]openscap\f[R] directory under
user workspace.
.PP
When the plugin receives the \f[B]scan\f[R] command from complyctl, it
will call \f[B]oscap\f[R] to scan the system using the tailoring policy
generated by the \f[B]generate\f[R] command and produce \f[B]oscap\f[R]
results which are ultimately interpreted by the plugin and returned to
complyctl as observations for a standardized OSCAL Assessment Results.
.PP
The generated remediation files from complyctl are based on the whole
policy, it\[cq]s not targeted to remediate specific findings.
\f[B]oscap\f[R] could be used to manually generate remediation artifacts
only for failed rules based on \f[B]oscap\f[R] scan result.
.SH FILES
\f[B]/usr/share/complytime/plugins/c2p\-openscap\-manifest.json\f[R]
Default plugin manifest file.
.PP
\f[B]/etc/complytime/config.d/c2p\-openscap\-manifest.json\f[R] Optional
drop\-in manifest file with customized plugin configurations.
.SH EXAMPLES
The following steps create a remediation Ansible Playbook that contains
only the remediations required to align your system with a specific
baseline, based on the complyctl scan result.
.PP
Step 1: generate a new assessment plan for the specified compliance
framework, e.g., anssi_bp28_minimal
.PP
$ complyctl plan anssi_bp28_minimal
.PP
Suppose the user workspace is \[ti]/complytime, the generated assessment
plan file would be \[ti]/complytime/assessment\-plan.json.
.PP
Step 2: generate PVP policy from the generated assessment plan
.PP
$ complyctl generate
.PP
With this step, the generated policy file could be found here:
\[ti]/complytime/openscap/policy/tailoring_policy.xml.
.PP
Step 3: scan environment with assessment plan to get the scan result
.PP
$ complyctl scan
.PP
After scanning, the generated openscap scan result is in
\[ti]/complytime/openscap/results/results.xml.
.PP
Step 4: find value of the result ID in scan result file
.PP
$ oscap info \[ti]/complytime/openscap/results/results.xml
.PP
The result ID in the example would be
xccdf_org.open\-scap_testresult_xccdf_complytime.openscapplugin_profile_anssi_bp28_minimal_complytime.
.PP
Step 5: generate a remediation Ansible Playbook based on the scan result
.PP
$ oscap xccdf generate fix \[en]fix\-type ansible \[en]result\-id
xccdf_org.open\-scap_testresult_xccdf_complytime.openscapplugin_profile_anssi_bp28_minimal_complytime
\[en]tailoring\-file
\[ti]/complytime/openscap/policy/tailoring_policy.xml \[en]output
output_remediations.yml \[ti]/complytime/openscap/results/results.xml
.SH SEE ALSO
complyctl(1), c2p\-openscap\-manifest.json(5), oscap(8)
.PP
See the upstream projects at https://github.com/complytime/complyctl and
https://github.com/OpenSCAP/openscap for more detailed documentation.
.SH COPYRIGHT
Â© 2025 Red Hat, Inc.\ complyctl\-openscap\-plugin is released under the
terms of the Apache\-2.0 license.
.SH AUTHORS
Qingmin Duanmu\c
.MT qduanmu@redhat.com
.ME \c.
